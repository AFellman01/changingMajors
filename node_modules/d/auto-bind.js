'use strict';

<<<<<<< HEAD
var copy             = require('es5-ext/object/copy')
  , normalizeOptions = require('es5-ext/object/normalize-options')
  , ensureCallable   = require('es5-ext/object/valid-callable')
  , map              = require('es5-ext/object/map')
  , callable         = require('es5-ext/object/valid-callable')
  , validValue       = require('es5-ext/object/valid-value')
=======
var copy       = require('es5-ext/object/copy')
  , map        = require('es5-ext/object/map')
  , callable   = require('es5-ext/object/valid-callable')
  , validValue = require('es5-ext/object/valid-value')
>>>>>>> dade7ea33ae9b7b47469401729da7eb5f8cc58d7

  , bind = Function.prototype.bind, defineProperty = Object.defineProperty
  , hasOwnProperty = Object.prototype.hasOwnProperty
  , define;

<<<<<<< HEAD
define = function (name, desc, options) {
=======
define = function (name, desc, bindTo) {
>>>>>>> dade7ea33ae9b7b47469401729da7eb5f8cc58d7
	var value = validValue(desc) && callable(desc.value), dgs;
	dgs = copy(desc);
	delete dgs.writable;
	delete dgs.value;
	dgs.get = function () {
<<<<<<< HEAD
		if (!options.overwriteDefinition && hasOwnProperty.call(this, name)) return value;
		desc.value = bind.call(value, options.resolveContext ? options.resolveContext(this) : this);
=======
		if (hasOwnProperty.call(this, name)) return value;
		desc.value = bind.call(value, (bindTo == null) ? this : this[bindTo]);
>>>>>>> dade7ea33ae9b7b47469401729da7eb5f8cc58d7
		defineProperty(this, name, desc);
		return this[name];
	};
	return dgs;
};

<<<<<<< HEAD
module.exports = function (props/*, options*/) {
	var options = normalizeOptions(arguments[1]);
	if (options.resolveContext != null) ensureCallable(options.resolveContext);
	return map(props, function (desc, name) { return define(name, desc, options); });
=======
module.exports = function (props/*, bindTo*/) {
	var bindTo = arguments[1];
	return map(props, function (desc, name) {
		return define(name, desc, bindTo);
	});
>>>>>>> dade7ea33ae9b7b47469401729da7eb5f8cc58d7
};
